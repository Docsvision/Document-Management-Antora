= Порядок обновления

[#conditions]
== Условия для обновления

[WARNING]
====
При установке данного обновлении будут перезаписаны настройки стандартных папок, поисковых запросов и представлений Приложения.
====

* Настройки созданных пользователем объектов не затрагиваются.
+
Если в настройки стандартных элементов Приложения были внесены изменения, которые нужно сохранить, выгрузите их перед обновлением и загрузите после обновления.
+
* Установка новой версии должна выполняться в нерабочее время. Потребуется остановка работы {dv} и обновление БД.
* Перед выполнением процедуры, создайте резервную копию БД {dv}.
* При обновлении версия клиентского дистрибутива должна быть равной версии серверного дистрибутива.

[#update]
== Обновление

. Остановите сервисы {dv} (в IIS и службах Windows) на серверах {dv} и СУБП.
. Установите новую версию приложения на сервере {dv} из пакета установки `{dv} 5 DocumentManagement server.msi`.
. На последней странице мастера установки установите флаг `*Обновить базу данных*`. Запустите сервисы {dv} (в IIS и службах Windows) на серверах {dv} и СУБП, затем нажмите *Готово*.
+
.Завершение установки
image::updateDbAutoMode.png[Завершение установки]
+
. Будет предложено выбрать обновляемые БД.
+
.Выбор обновляемых баз данных
image::updateDbList.png[Выбор обновляемых баз данных]
+
. Завершите настройку {dv}.
+
Если планируется обновлять несколько модулей, следующие действия следует выполнять один раз после установки новых версий всех модулей.
+
[CAUTION]
====
Следующие действия приведут к загрузке стандартных настроек приложения "{dm}" и модуля "{ad}". Чтобы сохранить собственные изменения, обновите БД по инструкции <<update-no-overwrite,Обновление базы данных {dv} без перезаписи стандартных настроек>>, после чего перейдите к шагу 4.
====
+
. Откройте Консоль настройки {dv}. Программа будет запущена в режиме мастера настройки.
+
Пользователь, от имени которого запускается "Консоль настройки {dv}" должен являться администратором {dv}, а также входить в группы {dv} в Справочнике сотрудников: "Администраторы УД", "Администраторы КС" и "Системная для WF".
+
. На странице "Базы данных" выберите рабочую БД {dv}, установите переключатель в режим *Использовать выбранную в списке базу данных* и нажмите *Далее*.
+
.Обновление базы данных
image::updateDb.png[Обновление базы данных]
+
. Будет предложено обновить базу данных до новой версии. Выберите вариант "ДА".
. На следующей странице не изменяйте выбор обновляемых библиотек карточек. Нажмите *Далее*.
+
.Обновление библиотеки карточек
image::updateCardLib.png[Обновление библиотеки карточек]
+
. На странице "Параметры базы данных" нажмите *Далее*. Появится запрос на подтверждение обновления -- согласитесь. Процесс обновления займет некоторое время.
. На странице настройки производительности и перезапуска IIS нажмите *Далее*.
. На странице "{dm} и {ad}" нажмите *Далее*, чтобы загрузить стандартную конфигурацию приложения {dm}.
. Подтвердите настройки Workflow и выйдите из мастера.
. Обновите версию приложения на всех узлах кластера {dv}, СУБП и Web-клиента.
. Клиентские компоненты приложения на компьютерах пользователей будут обновлены автоматически при запуске {wincl}а.
+
Самостоятельно обновить клиентские компоненты можно из пакета установки `{dv} 5 DocumentManagement client.msi`.

[#update-no-overwrite]
== Обновление базы данных {dv} без перезаписи стандартных настроек

. Измените в редакторе реестра Windows значение параметра `HKLM\SOFTWARE\DocsVision\Platform\5.5\Console\WizardMode` на "0".
. Откройте Консоль настройки {dv}.
+
Пользователь, от имени которого запускается "Консоль настройки {dv}" должен являться администратором {dv}, а также входить в группы {dv} в Справочнике сотрудников: "Администраторы УД", "Администраторы КС" и "Системная для WF".
+
. Перейдите в раздел настроек Настройки сервера -&gt; Базы данных.
. Нажмите кнопку Мастер баз данных. Будет открыто окно "Мастер БД {dv}".
. Выберите обновляемую БД. Переключите режим в значение "Обновить выбранную в списке базу данных".
. Выполните обновление стандартным образом (см. руководство администратора модуля "{pl}", пункт "Обновление базы данных"). На шаге выбора загружаемых модулей, откажитесь от загрузки модулей, настройки которых требуется сохранить.
