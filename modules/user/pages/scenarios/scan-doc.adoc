= Сканирование документов

Кроме обычных вложений в виде файлов, к карточке документа может быть приложен отсканированный документ. Поддерживается два варианта сканирования:

Простое сканирование::
Файл прикрепляется к карточке в растровом графическом формате, в котором текст не может быть отредактирован.

Сканирование с распознаванием::
Файл прикрепляется к карточке в формате, допускающем редактирование.

[#simple]
== Простое сканирование с добавление файла в карточку

В этом случае к карточке документа будет приложен файл в графическом формате. Настройки сканирования определяются администратором xref:desdirs:systemsettings:general-settings.adoc#scan[в справочнике "Системные настройки"].

Для корректной работы функции сканирования необходимо, чтобы на компьютере был установлен и включён компонент _Служба загрузки изображений (Windows Image Acquisition, WIA)_. В серверных версиях _ОС Windows_ этот компонент может быть отключён по умолчанию. Для его включения перейдите к разделу menu:Панель управления[Администрирование > Диспетчер сервера > Компоненты] и отметьте пункт `*Возможности рабочего стола*`.

.Чтобы добавить в карточку файл, полученный при помощи простого сканирования:
. В _Области вложений_ карточки _Документ_ правой клавишей мыши вызовите контекстное меню, затем выберите команду _Добавить отсканированный файл_.
+
Будет открыто окно _Сканирование_.
+
.Окно "Сканирование"
image::scan-window.png[Окно "Сканирование"]
+
.Возможности сканирования соответствуют набору команд на панели инструментов окна:
[cols="15%,85%",options="header"]
|===
|Команда |Описание

|image:buttons/scanner-open.png[Сканер открыт]
|Начать сканирование.

|image:buttons/scanner-magn-glass.png[Сканер с лупой]
|Выбрать сканер.

|image:buttons/save.png[Дискета]
|Сохранить результат сканирования в графическом файле. Формат файла выбирается в раскрывающемся списке:

image:scan-formats.png[Раскрывающийся список форматов]

|image:buttons/scan-folder.png[Папка с отсканированным файлом]
|Открыть графический файл.

|image:buttons/x-red-big.png[Красный крестик]
|Очистить результат сканирования (отказаться от изображения).
|===
+
Поскольку диалог сканирования позволяет работать с многостраничными документами, в нём предусмотрена одновременная работа с несколькими изображениями. Для навигации по ним в правой части панели инструментов имеются следующие команды:
+
[cols="15%,85%",options="header"]
|===
|Команда |Описание
|image:buttons/first-page.png[Треугольник вершиной влево с перекладиной]
|Перейти на первую страницу.

|image:buttons/prev-page.png[Треугольник вершиной влево]
|Перейти на предыдущую страницу.

|image:buttons/next-page.png[Треугольник вершиной вправо]
|Перейти на следующую страницу.

|image:buttons/last-page.png[Треугольник вершиной вправо с перекладиной]
|Перейти на последнюю страницу.

|image:buttons/rotate-left.png[Стрелка влево]
|Повернуть изображение против часовой стрелки.

|image:buttons/rotate-right.png[Стрелка вправо]
|Повернуть изображение по часовой стрелке.

|image:buttons/zoom-in.png[Лупа с плюсом]
|Увеличить изображение.

|image:buttons/zoom-out.png[Лупа с минусом]
|Уменьшить изображение.

|image:buttons/select-scanner.png[Синий сканер]
|Выбрать тип используемого сканера: (WIA или TWAIN).
|===
+
. Нажмите на кнопку и выберите тип используемого сканера.
+
.После задания параметров сканирования, возможны два варианта действий:
* Если сканер поддерживает автоматический выбор источника сканирования, будет запущен процесс сканирования.
* Если сканер не поддерживает автоматический выбор источника сканирования, следует выбрать источник вручную. Для этого, удерживая клавишу kbd:[Shift], нажмите на кнопку *ОК*.
* Если сканер поддерживает разные способы сканирования (планшетное, потоковое), появится окно _Выберите источник сканирования_, в котором следует выбрать нужный источник.
+
. Нажмите на кнопку image:buttons/scanner-open.png[Сканер открыт] *Начать сканирование*.
+
Если результатом сканирования должен быть графический файл, то после нажатия кнопки *Сохранить* и закрытия диалога сканирования, к карточке автоматически будет приложен этот файл. Имя файла не должно быть длиннее `255` символов.
+
При выборе варианта с распознаванием будет запущен интерфейс _ABBYY FineReader Engine 11.0._ Результатом работы сканирования с распознаванием текста будут два набора файлов: документ с редактируемым текстом (основной файл) и исходные изображения (дополнительные файлы).

Также может выполняться сканирование графических файлов с последующим преобразованием в форматы документов (например, PDF). Параметры сжатия изображений определяются администратором.

.При сохранении в PDF имеются следующие особенности:
* Если формат исходного изображения -- TIFF (черно-белый), будет использоваться сжатие _CCITT Group 4 fax encoding_ и вставка в PDF.
* Если на входе не черно-белый TIFF, он будет преобразован в JPEG, сжатие в соответствии с настройками, указанными для сканирования в JPEG, и вставка в PDF.

При сохранении в формате TIFF используется сжатие LZW.

[#recognition]
== Сканирование с распознаванием

При добавлении документов со сканера можно использовать сканирование с распознаванием текста. В этом случае к карточке документа будет приложен файл в формате `.doc` или `.docx`, а также, по желанию, исходное изображение.

Распознавание текста осуществляется с помощью "ABBYY FineReader Engine 11.0", который должен быть xref:dev@backoffice:admin:prepare-abbyy.adoc[установлен и настроен].

.Чтобы добавить в карточку файл, полученный при помощи сканирования с распознаванием:
. В _Области вложений_ карточки _Документ_ правой клавишей мыши вызовите контекстное меню, затем выберите команду _Добавить отсканированный и распознанный файл_.
+
Будет открыто окно _Сканирование с распознаванием_.
+
.Окно "Сканирование и распознавание"
image::scan-recognition.png[Окно "Сканирование и распознавание"]
+
Помимо элементов управления сканированием, данное окно содержит дополнительные элементы, предназначенные для распознавания текста:
+
[cols="15%,85%",options="header"]
|===
|Команда |Описание
|image:buttons/scan-recognize.png[Отсканированный файл с листом с буквой А]
|Распознать.

|image:buttons/scan-recognize-save.png[Дискета с буквой А]
|Сохранить распознанный документ. Документ сохраняется в выбранном формате. Формат документа выбирается в раскрывающемся списке: image:scan-formats-recognize.png[Раскрывающийся список форматов].
|===
+
Также окно содержит элементы управления компонента _ABBYY FineReader Engine 11.0_, позволяющие редактировать полученное в результате сканирования изображение, выделять области для детального просмотра и выполнять другие операции. Чтобы узнать, как работать с _ABBYY FineReader Engine 11.0_, обратитесь к документации программы. Для начала процесса сканирования нажмите на кнопку image:buttons/scanner-open.png[Сканер открыт] *Начать сканирование*.
+
При этом появится диалог для настройки сканера, в котором необходимо указать тип сканера и вид сканируемого изображения.
+
В случае успешного выполнения операции, отсканированное изображение появится в окне _Сканирование с распознаванием_:
+
--
* На левой панели окна, в перечне доступных изображений.
* На центральной панели окна, предназначенной для предварительного просмотра файла.
* На нижней панели окна для детального просмотра и оценки качества полученного изображения.
--
+
Распознавания текста документа в автоматическом режиме не произойдет.
+
.Результат сканирования
image::scanned-with-reconition.png[Результат сканирования]
+
. Чтобы запустить процесс распознавания, нажмите на кнопку image:buttons/scan-recognize.png[Отсканированный файл с листом с буквой А] *Распознать*.
+
При распознавании будет отображаться индикатор процента выполнения. В случае успешного выполнения операции распознанный текст будет отображен на правой панели окна.
+
.Результат распознавания
image::scan-recognized.png[Результат распознавания]
+
. Для сохранения полученного документа выберите требуемый формат, затем нажмите на кнопку image:buttons/scan-recognize-save.png[Дискета с буквой А] *Сохранить распознанный документ*. Имя файла не должно быть длиннее `255` символов.
