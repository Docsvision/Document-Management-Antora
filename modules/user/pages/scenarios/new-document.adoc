= Создание карточки документа

Для создания новой карточки документа выполните следующие действия.

. В программе {wincl} выберите папку назначения и создайте новую карточку _Документ УД_ одним из следующих способов:
+
* Командой *Создать карточку* ленты инструментов.
* Командой *Создать документ* ленты инструментов.
+
Команда предназначена для создания документов без размещения в каких-либо пользовательских папках, с возможностью выбора вида. Команда доступна для тех видов карточек, для которых в _Справочнике видов карточек_ настроен режим создания _Документ без размещения_. По умолчанию команда настроена для вида _Файл_.
+
.Команда для создания документа без размещения
image::new-doc.png[Команда для создания документа без размещения]
+
* Из контекстного меню папки назначения.
* Перетаскиванием из файловой системы в область просмотра содержимого папки.
* Из открытой карточки _Документ_ с помощью кнопки *Сохранить и создать*. При этом сохраняется текущая карточка и создаётся новая карточка _Документ_ того же вида.
* По выбранному шаблону с помощью кнопки *Создать карточку по шаблону* на вкладке _Карточка_.
+
[CAUTION]
====
Необходимые шаблоны карточек должны быть предварительно созданы и настроены _Администратором_ системы.
====
+
* С использованием элемента управления `_Связанные карточки_`, расположенного на вкладке _Ссылки_ ранее созданной карточки.
* При помощи ручного сканирования штрих-кода карточки.
+
. Заполните атрибуты карточки. Набор атрибутов различается для документов разных видов и описывается в соответствующих разделах, посвящённых созданию карточек документов того или иного вида.
. Сохраните выполненные изменения, нажав кнопку *Сохранить* в созданной карточке _Документ_, либо *Сохранить и создать* для сохранения и создания новой карточки того же вида.

[#drag-drop]
== Создание карточки при перетаскивании файла в {wincl}

Карточка типа _Документ_ (или дочерних видов) может быть создана путем перетаскивания файла в _Область представления_ или пользовательскую папку в _Дереве папок_ {wincl}а.

Данный способ также называется импортом документов. Файлы можно перетащить из _Проводника Windows_ или с _Рабочего стола_. Также можно перетащить письма и вложения из _Microsoft Outlook_.

Перетащить можно как один файл, так и группу файлов. При перетаскивании файла в пользовательскую папку могут применяться ограничения, позволяющие создавать карточки документов только определенных видов.

При перетаскивании одного файла будет создана карточка документа (для папки -- разрешенного вида), файл будет добавлен в карточку как _основной_. Перетащить файл можно также на уже открытую карточку, при этом файл будет приложен в качестве _основного_. Созданная карточка будет сохранена в системной папке menu:Карточки[{bo}] (папка доступна только администратору), а в выбранной пользовательской папке будет отображен ярлык на данную карточку.

.При перетаскивании группы файлов появится окно, в котором требуется выбрать способ создания карточки:
* Либо одну карточку с несколькими вложениями.
* Либо по отдельной карточке на каждое вложение.

По умолчанию для всех перетаскиваемых файлов предлагается создать одну карточку _Документ_. При этом необходимо выбрать, какие из файлов будут основными. Остальные файлы будут добавлены в качестве дополнительных.

Для определения _основных_ файлов необходимо выставить флаги в полях, расположенных слева от их названия. В поле _Вид_ можно определить вид создаваемой карточки. Если вид не задан, будет создана карточка первого доступного вида документа.

.Окно создания одной карточки при перетаскивании группы файлов
image::file-group-one-card.png[Окно создания одной карточки при перетаскивании группы файлов]

Если требуется для каждого файла создать отдельную карточку, выберите опцию *Несколько документов*. В этом случае, выбор файлов будет запрещен. В списке можно выделить несколько файлов и указать для них нужный вид в поле _Вид_ (для множественного выделения удерживайте kbd:[Ctrl] или kbd:[Shift]).

Таким образом, за один шаг можно назначить произвольный группе файлов нужный вид, без необходимости делать это вручную для каждого файла. Файлы из диалога можно удалять с помощью команды _Удалить_ контекстного меню, либо клавишей kbd:[Del] на клавиатуре.

.Окно создания нескольких карточек для каждого из перетаскиваемых файлов
image::file-group-many-cards.png[Окно создания нескольких карточек для каждого из перетаскиваемых файлов]

После задания всех необходимых настроек, нажмите кнопку *Принять*. Новые карточки будут созданы и открыты. Для файлов Microsoft Office или OpenOffice свойства файла автоматически будут перенесены на соответствующие поля карточки. К таким свойствам относится, например, автор документа, название документа, наличие электронной подписи.

Создание карточек методом перетаскивания поддерживает работу с электронными подписями (ЭП) в формате `.p7s`.

.При импорте файла ".p7s" нужно учитывать следующие особенности:
* Перетаскивание в _Область представления_:
** Если файл `.p7s` содержит в себе файл, создается новая карточка документа выбранного вида. В качестве основного файла к карточке прикладывается файл из файла `.p7s`. Формируются соответствующие ЭП.
** Если файл `.p7s` не содержит файла, карточка не будет создана.
* Перетаскивание на область _Основного файла_ в карточке:
** Если файл `.p7s` содержит в себе файл, и в поле _Основной файл_ также нет файла, файл из файла `.p7s` добавляется в поле _Основной файл_. Формируются соответствующие ЭП.
** Если файл `.p7s` содержит в себе файл, и этого файла нет в поле _Основной файл_, будет предложено его добавить. Если файл есть, будет предложено обновить версию или заменить (если версионирование файлов отключено). В обоих случаях будут сформированы соответствующие ЭП.
** Если файл `.p7s` не содержит в себе файл, и в поле _Основной файл_ также нет файла, будет выдано сообщение об отсутствии файла данных в криптографическом сообщении.
** Если файл `.p7s` не содержит в себе файл, но в поле _Основной файл_ уже имеется файл, ЭП будет добавлена к текущей версии основного файла.

[NOTE]
====
Для открытия файлов формата `.p7s` можно воспользоваться сторонним приложением _P7S Viewer_.
====

[#barcode]
== Создание карточки по штрих-коду

Для карточек вида _Документ_ предусмотрена возможность создания карточки по штрих-коду.

.Для создания карточки данным способом необходимо выполнение следующих условий:
* У пользователя должна быть открыта программа {wincl}.
* Должен быть настроен ручной сканер для возможности сканирования штрих-кодов.
* В _Справочнике видов карточек_ для вида документа, которые предполагается создавать при сканировании, должен быть указан способ создания _Сканирование штрих-кода_.
* В настройках {wincl}а должен быть определен вид карточки, создаваемой по штрих-коду.

Если все описанные выше настройки выполнены, после сканирования штрих-кода ручным сканером создание карточки будет произведено по следующим правилам:

* Если карточка с таким штрих-кодом найдена в системе, она будет открыта.
+
Если будет найдено более одной карточки, появится сообщение: `Найдено Х карточек.` В случае нажатия на кнопку *ОК* будут открыты все найденные карточки.
+
* Если карточка с таким штрих-кодом не найдена в системе, появится сообщение: `Карточек с таким штрих-кодом не найдено. Вы хотите создать новую?`.
+
При нажатии на кнопку *ОК* карточка будет создана в соответствии с настройками, заданными в _Справочнике видов карточек_ и параметрах {wincl}а.
