= Добавление файла в карточку

.Файл можно добавить в карточку следующими способами:
* При создании карточки "Документ".
* С помощью перетаскивания из файловой системы.
* Путем простого сканирования файла.
* Путем сканирования файла с распознаванием.
* С помощью перетаскивания из приложения _Microsoft Outlook_.
* С использованием команды контекстного меню области вложений карточки _Документ_.
* С помощью перетаскивания приложенного файла из другой карточки.
* Из буфера обмена Windows.

Также специалистами по внедрению системы могут быть настроены дополнительные способы добавления файлов в _Справочнике видов карточек_:

* Основной файл может будет автоматически создан по шаблону при создании карточки.
* Карточка может изначально содержать основной и/или дополнительные файлы.
* При создании карточки может автоматически выдаваться запрос на добавление основного файла со сканера или с файловой системы.

[#upload-specifics]
== Особенности механизма загрузки файлов

include::partial$excerpts.adoc[tags=async]

[#drag-system]
== Добавление перетаскиванием из файловой системы

Методом перетаскивания в карточку можно добавить как _основной_, так и _дополнительный_ файл.

.Чтобы добавить файл в карточку при помощи перетаскивания из файловой системы:
. Перетащите файл из _Проводника_ на _Область вложений_ карточки _Документ_:
+
* В область _Основные файлы_, чтобы добавить файл как _основной_.
* В область _Дополнительные файлы_, чтобы добавить файл как _дополнительный_.

Файлы карточки отображаются в _Области вложений_.

[#context-menu]
=== Добавление командой контекстного меню из файловой системы

Командами контекстного меню в карточку можно добавить как _основной_, так и _дополнительный_ файл.

.Чтобы добавить файл в карточку при помощи команды контекстного меню:
. Откройте карточку _Документ_.
. Если файлов в карточке нет, в _Области вложений_ правой клавишей мыши вызовите контекстное меню, затем выберите требуемую команду:
+
* menu:Добавить файл из файловой системы[Основной], чтобы добавить файл как _основной_;
* menu:Добавить файл из файловой системы[Дополнительный], чтобы добавить файл как _дополнительный_.
+
.Контекстное меню для добавления файла из файловой системы
image::file-attach-context.png[Контекстное меню для добавления файла из файловой системы]
+
Название файла будет отображено в _Области вложений_.
+
. Если файлы уже добавлены в карточку, перед вызовом контекстного меню установите курсор в _Области вложений_ на области _основных_ или _дополнительных_ файлов (в зависимости от того, как будет использоваться файл). Затем вызовите контекстное меню и выберите команду _Добавить файл из файловой системы_.
+
Файл будет добавлен в ту область, откуда было вызвано контекстное меню.

[#drag-outlook]
== Добавление перетаскиванием из MS Outlook

Файл может быть добавлен в карточку _Документ_ с помощью перетаскивания из приложения _Microsoft Outlook_ (из открытого письма и из области просмотра). Добавлено может быть как письмо, так и вложенный файл.

Поддерживается и обратное действие: при перетаскивании файлов из карточки в окно _Microsoft Outlook_ создается письмо с соответствующим вложением. В поле *Тема* копируется название файла, а в поле вложений копируется файл.

Чтобы перетащить письмо из MS Outlook выполните следующие действия:

. Откройте карточку _Документ_.
. Перетащите письмо в _Область вложений_.
+
Письмо будет приложено к карточке в виде файла с расширением `.msg`. Файл, вложенный в письмо, будет добавлен в том же формате, что и в письме.

[#drag-card]
== Добавление перетаскиванием из другой карточки "Документ"

Файл может быть добавлен в карточку _Документ_ путем перетаскивания из другой карточки.

. Откройте две карточки _Документ_, исходную и целевую.
. Перетащите файл из _Области вложений_ исходной карточки в _Область вложений_ целевой карточки.
+
Если в целевой карточке нет ни одного добавленного файла, перетаскиваемый файл по умолчанию будет добавлен как основной.
+
Если в карточке уже хранятся ранее приложенные файлы, при перетаскивании новых файлов появится диалог для выбора типа добавляемых файлов.
+
. Выберите тип добавляемого файла, затем нажмите на кнопку *Принять*.
+
.Выбор типа файла для добавления
image::select-file-type.png[Выбор типа файла для добавления]
+
Файл будет добавлен в соответствующую часть _Области вложений_.

[#clipboard]
== Добавление из буфера обмена

Скопированный в буфер обмена Windows файл можно добавить в карточку с помощью команды контекстного меню или сочетания клавиш. Данным способом можно добавить один или сразу несколько основных или дополнительных файлов.

Чтобы добавить файл из буфера обмена:

. Скопируйте нужный файл в буфер обмена.
. Откройте карточку _Документ_.
. Если файлов в карточке нет, в _Области вложений_ правой клавишей мыши вызовите контекстное меню, затем выберите команду _Вставить_.
+
Файлы будут добавлены как основные. Название файлов будет отображено в _Области вложений_.
+
Если в буфере обмена нет файлов или их добавление запрещено ролевой моделью, команда _Вставить_ будет отключена.
+
Если операция добавления отключена в автомате состояний, указанная команда контекстного меню будет скрыта.
+
. Если в карточке уже есть основные файлы (дополнительных файлов нет), после вызова команды _Вставить_ выберите тип добавляемого файла: основной или дополнительный.
+
.Выбор типа файла для добавления
image::select-file-type.png[Выбор типа файла для добавления]
+
Все файлы из буфера обмена будут добавлены в область, соответствующую выбранному типу файла.
+
. Если в карточке есть основные и дополнительные файлы, перед вызовом контекстного меню установите курсор в _Области вложений_ на области _основных_ или _дополнительных_ файлов (в зависимости от того, как будет использоваться файл). Затем вызовите контекстное меню и выберите команду _Вставить_.
+
Файлы будут добавлены в ту область, откуда было вызвано контекстное меню.

[NOTE]
====
Вместо команды _Вставить_ можно использовать стандартное сочетание клавиш kbd:[Ctrl+V] или kbd:[Shift+Ins]. Перед этим кликните по _Области вложений_, чтобы фокус перешел к ней (при этом данная область графически не выделяется).

Ограничения на добавление файлов данным способом аналогичны ограничениям на добавление файлов с помощью команды _Вставить_.

Используя сочетание клавиш kbd:[Ctrl+C] или kbd:[Ctrl+Ins] можно скопировать выделенный в _Области вложений_ файл в буфер обмена.
====
