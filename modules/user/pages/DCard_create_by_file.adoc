= Создание карточки при перетаскивании файла в {wincl}

Карточка типа _Документ_ (или дочерних видов) может быть создана путем перетаскивания файла в _Область представления_ или пользовательскую папку в _Дереве папок_ {wincl}а. Данный способ также называется импортом документов. Файлы можно перетащить из _Проводника Windows_ или с _Рабочего стола_. Также можно перетащить письма и вложения из _Microsoft Outlook_.

Перетащить можно как один файл, так и группу файлов. При перетаскивании файла в пользовательскую папку могут применяться ограничения, позволяющие создавать карточки документов только определенных видов.

При перетаскивании одного файла будет создана карточка документа (для папки - разрешенного вида), файл будет добавлен в карточку как _основной_. Перетащить файл можно также на уже открытую карточку, при этом файл будет приложен в качестве _основного_. Созданная карточка будет сохранена в системной папке *Карточки - {bo}* (папка доступна только администратору), а в выбранной пользовательской папке будет отображен ярлык на данную карточку.

При перетаскивании группы файлов появится окно, в котором требуется выбрать способ создания карточки:

* либо одну карточку с несколькими вложениями;
* либо по отдельной карточке на каждое вложение.

По умолчанию для всех перетаскиваемых файлов предлагается создать одну карточку _Документ_. При этом необходимо выбрать, какие из файлов будут основными. Остальные файлы будут добавлены в качестве дополнительных. Для определения _основных_ файлов необходимо выставить флаги в полях, расположенных слева от их названия. В поле *Вид* можно определить вид создаваемой карточки. Если вид не задан, будет создана карточка первого доступного вида документа.

image::Dcard_create_by_file_one.png[[.fig--title-label]##Рис. 1. ##Окно создания одной карточки при перетаскивании группы файлов]

Если требуется для каждого файла создать отдельную карточку, выберите опцию [.ph .uicontrol]*Несколько документов*. В этом случае, выбор файлов будет запрещен. В списке можно выделить несколько файлов и указать для них нужный вид в поле *Вид* (для множественного выделения удерживайте [.kbd .ph .userinput]`Ctrl` или [.kbd .ph .userinput]`Shift`). Таким образом, за один шаг можно назначить произвольный группе файлов нужный вид, без необходимости делать это вручную для каждого файла. Файлы из диалога можно удалять с помощью команды *Удалить* контекстного меню, либо клавишей [.kbd .ph .userinput]`Del` на клавиатуре.

image::Dcard_create_by_file_few.png[[.fig--title-label]##Рис. 2. ##Окно создания нескольких карточек для каждого из перетаскиваемых файлов]

После задания всех необходимых настроек, нажмите кнопку [.ph .uicontrol]*Принять*, после чего новые карточки созданы и открыты. Для файлов Microsoft Office или OpenOffice свойства файла автоматически будут перенесены на соответствующие поля карточки. К таким свойствам относится, например, автор документа, название документа, наличие электронной подписи.

Создание карточек методом перетаскивания поддерживает работу с электронными подписями (ЭП) в формате p7s. При импорте файла p7s нужно учитывать следующие особенности:

* Перетаскивание в _Область представления_:
** Если p7s-файл содержит в себе файл, создается новая карточка документа выбранного вида, в качестве основного файла к ней прикладывается файл из p7s-файла. Формируются соответствующие ЭП.
** Если p7s-файл не содержит файла, карточка не будет создана.
* Перетаскивание на область Основного файла в карточке:
** Если p7s-файл содержит в себе файл, и в поле "Основной файл" также нет файла, файл из p7s-файла добавляется в поле "Основной файл". Формируются соответствующие ЭП.
** Если p7s-файл содержит в себе файл, и этого файла нет в поле "Основной файл", будет предложено его добавить, а если файл есть -- обновить версию или заменить (если версионинг файлов отключен). В обоих случаях будут сформированы соответствующие ЭП.
** Если p7s-файл не содержит в себе файл, и в поле "Основной файл" также нет файла, будет выдано сообщение об отсутствии файла данных в криптографическом сообщении.
** Если p7s-файл не содержит в себе файл, но в поле "Основной файл" уже имеется файл, ЭП будет добавлена к текущей версии основного файла.

[NOTE]
====
Для открытия файлов формата p7s можно воспользоваться сторонним приложением _P7S Viewer_.
====

